{{extend 'layout.html'}}

{{block header}}
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBxR53fN_ZDwYgoJ31tYUcAc-riycqih-w&callback=initMap"
  type="text/javascript"></script>
<script src="{{=URL('static', 'js/vue.js')}}"></script>


<script>
    var tracks_url = "{{=URL('api', 'get_tracks')}}";
    var recommendation_url = "{{=URL('api', 'get_recommendation')}}";
</script>
{{end}}

{{if auth.user_id:}}

    {{block top-nav}} <!-- Overwrite nav bar -->
        <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
            <a href="{{=URL('default', 'index')}}">
                <div class="navbar logo-container pull-left">
                    <span class="navbar logo">
                        Plan-It
                    </span>
                </div>
            </a>

            {{block nav-buttons}} <!-- Overwrite nav buttons -->
                <a href="{{=URL('default', 'home')}}">
                    <div class="navbar pull-left nav-link">
                        <span class="navbar nav-link-text">
                            Home
                        </span>
                    </div>
                </a>

                <!-- Dropdown menu for Plan selection -->
                <div class="navbar pull-left nav-link">
                    <span class="navbar nav-link-text dropdown">
                    My Plans
                        <i class="fa fa-angle-down"></i>
                        <div class="dropdown-content">
                            <!-- This is where you would iterate over the plans retrieved
                                from the database and create a link for each one -->
                            {{for plan in [1, 2, 3]:}}
                            <!-- When clicked the link should NOT reload the page but
                                instead populate the appropriate containers with the
                                selected plan's information -->
                            <a href="">Example Plan {{=plan}}</a>
                            {{pass}}
                        </div>
                    </span>
                </div>

                <div class="navbar pull-right nav-link">
                    <span class="navbar nav-link-text dropdown">
                    {{=auth.user.first_name}}
                        <i class="fa fa-angle-down"></i>
                        <div class="dropdown-content">
                            <a href="{{=URL('default','user',args=['logout'])}}">Logout</a>
                        </div>
                    </span>
                </div>
            {{end}}
        </nav>
    {{end}}

    <div class="home-container">
        <div id="suggestion-container" class="pull-left scrollbar">

            <!--suggestion list code is here-->
            <div id="vue-div" class="display:none">
                <div v-for = "rec in recommendation">
                    <div class="sugg-card">
                        <div class="pull-left">
                            <a href="#">
                                <img class="imgClass-thumbnail" src="http://3.bp.blogspot.com/-IbEOTNtCMyU/TfCAdHaAxEI/AAAAAAAAA8U/EATib38SSAM/s320/joe-mcelderry.jpg">
                            </a>
                        </div>
                        <div class="sugg-card-body">
                            <h2>${rec.name}</h2>
                            <p>${rec.neighborhood}</p>
                        </div>
                        <div class="sugg-card-footer">
                            <span style="display: inline-block; float: left;">
                                Price: ${rec.price}
                            </span>
                            <span class="rating">
                                Rating: ${rec.rating}
                            </span>
                        </div>
                    </div>
                </div>
                <div v-if="has_more" class="show_more"><button class="btn btn-default" v-on:click="get_more_rec()">Load more</button></div>
            </div>
            <!--till here-->

        </div>
        <div id="calendar-container" class="pull-left scrollbar">
            <ul>
            {{for stop in [1, 2, 3]:}}
                <li class="">Stop {{=stop}}</li>
            {{pass}}
            </ul>
        </div>

        <div id="map-container" class = "pull-left scrollbar">
            <h2>Column for map</h2>
            <title>Simple Map</title>
            <meta name="viewport" content="initial-scale=1.0">
            <meta charset="utf-8">
            <style>
              /* Always set the map height explicitly to define the size of the div
               * element that contains the map. */
              #map {
                height: 100%;
              }
              /* Optional: Makes the sample page fill the window. */
              html, body {
                height: 100%;
                margin: 0;
                padding: 0;
              }
            </style>
            <div id="map"></div>
                <script>
                  var map;
                  function initMap() {
                    map = new google.maps.Map(document.getElementById('map'), {
                      center: {lat: -34.397, lng: 150.644},
                      zoom: 8
                    });
                  }
                </script>
                <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBxR53fN_ZDwYgoJ31tYUcAc-riycqih-w&callback=initMap"
                async defer></script>
        </div>
    </div>

{{else:}}

    {{=redirect(URL('default', 'user', args=['login']))}}

{{pass}}


<script src="{{=URL('static', 'js/default_index.js')}}"></script>

